# Cortana Grid 项目 - 增加“关系”字段实施计划

**目标**  
在人员信息中增加一个用于描述“与其他人员关系”的自由文本字段。  
采用最简实现方式：直接在人员表中新增一个文本字段，前端使用普通文本输入框，不涉及下拉菜单、不建立关联关系表、不实现反向关系、不做统计或复杂查询功能。

**计划性质**：最小范围功能增强  
**预计完成时间**：当天或次日（改动范围较小）  
**当前日期**：2026年2月9日

## 1. 数据库层调整

### 1.1 生产环境 / 当前运行数据库  
已由负责人手工执行字段添加操作（不再重复描述具体语句）。

### 1.2 结构定义文件更新  
**文件**：schema.sql  

**调整内容**：  
在人员表创建语句中，新增一个文本类型的字段，用于记录与其他人员的关系描述。

**建议插入位置**：  
备注（notes）字段之后，删除标记（is_deleted）字段之前。

**字段命名建议**：relation  
**字段类型**：文本类型（允许为空）  
**注释建议**：简要说明该字段用于记录自由文本形式的人员关系描述

**目的**：  
确保未来新建数据库或重新初始化时，表结构自动包含该字段，保持定义一致性。

## 2. 程序与界面调整范围

| 涉及模块 / 文件                     | 主要工作内容                                      | 改动规模 |
|-------------------------------------|---------------------------------------------------|----------|
| 人员数据访问层（person_repo.py）    | 查询单条记录、新增、更新时包含该字段              | 中等     |
| 编辑人员页面模板                    | 在表单中增加一个普通文本输入框                    | 小       |
| 查看人员详情页面模板                | 在详情展示区域增加一行，用于显示该字段内容        | 小       |
| 人员列表页面模板                    | （可选）在列表中增加一列，简要显示该字段内容      | 极小（可选） |

### 2.1 核心调整要点

- 数据读写逻辑：所有涉及单条人员记录的读取、创建、更新操作都需要考虑该字段的存取
- 编辑界面：在合适的位置（建议靠近备注区域）增加一个单行文本输入框，提供简单的填写提示
- 详情界面：增加一行展示，支持空值时显示友好提示（如“未填写”）
- 列表界面（可选）：如需展示，可增加一列，内容较长时建议截断显示

## 3. 验证与测试要点

- 新建人员记录时能够正常填写该字段，保存后数据被正确记录
- 编辑已有记录时，该字段原有内容能够正确回显到输入框
- 修改字段内容后保存，数据能够正确更新到数据库
- 查看详情时，字段内容正常显示（包括未填写时的处理）
- （如做了列表展示）列表页面能够正确显示或简略显示该字段
- 删除数据库文件后重新初始化，确认新生成的表结构包含该字段

## 4. 完成判定标准

- 表结构定义文件已更新并包含新字段
- 编辑功能能够正常输入和保存该字段
- 详情展示能够正确呈现字段内容（含空值处理）
- 现有手工添加字段的记录在系统中显示正常
- 无因该字段导致的保存失败、页面错误或异常

**优先级**：中（业务信息补充类）  
**预计工时**：1–3 小时（视对代码熟悉程度而定）  
**备注**：本次仅为最简功能添加，不包含任何校验、搜索、统计、权限调整或未来扩展规划。
